!function(t,e){t.BLOG=t.BLOG||{};const s=e.body,i=e.querySelector.bind(e),o=e.querySelectorAll.bind(e),a=i("html"),n=i("#gotop"),l=i("#menu"),c=i("#header"),r=i("#mask"),d=i("#menu-toggle"),h=i("#menu-off"),m=i("#loading"),g=i("#main"),p=i(".post-header"),v=i("#post-toc"),L=i("#search-wrap"),f=i("#pageShare"),u=i("#shareFab"),$=i("#menuShare"),E=t.requestAnimationFrame;let w="ontouchstart"in t&&/Mobile|Android|iOS|iPhone|iPad|iPod|Windows Phone|KFAPWI/i.test(navigator.userAgent)?"touchstart":"click";const S=/micromessenger/i.test(navigator.userAgent),y=()=>{},T=(t,e=100)=>{let s=0;return(...i)=>{const o=Date.now();o-s>e&&(t.apply(this,i),s=o)}};let O=c?.clientHeight||0,b=t.innerWidth,x=p?.clientHeight||0;const k=()=>a.scrollTop||s.scrollTop,B={goTop(e){const s=k(),i=Math.max(Math.abs(s-e)/12,1);if(s>e){if(s-i<=e)return t.scrollTo(0,e),void(this.toc&&this.toc.actived(e));t.scrollTo(0,s-i),E(this.goTop.bind(this,e))}else s<e?(t.scrollTo(0,Math.min(s+i,e)),E(this.goTop.bind(this,e))):this.toc&&this.toc.actived(e)},toggleGotop(e){n.classList.toggle("in",e>t.innerHeight/2)},toggleMenu(e){if(e)l.classList.remove("hide"),b<1241&&(r.classList.add("in"),l.classList.add("show"),S?(g.classList.add("lock"),g.scrollTop=k()):a.classList.add("lock"));else if(l.classList.remove("show"),r.classList.remove("in"),S){const e=g.scrollTop;g.classList.remove("lock"),t.scrollTo(0,e)}else a.classList.remove("lock")},fixedHeader(t){c.classList.toggle("fixed",t>O)},initHeaderLink(){const t=[".post-card .post-content > h1",".post-card .post-content > h2",".post-card .post-content > h3",".post-card .post-content > h4",".post-card .post-content > h5",".post-card .post-content > h6"].join(","),e=o(t);for(const t of e){const e=document.createElement("a");e.href=`#${t.id}`,e.className="headerlink",t.insertBefore(e,t.firstChild)}},toc:(()=>{if(!t.BLOG.SINGLE)return;const e=document.getElementById("TableOfContents");if(!e)return;const s=x,i=O,o=e.querySelectorAll("a:first-child"),a=(e.getElementsByTagName("li"),document.getElementsByClassName("headerlink"));v.appendChild(e);let n=-1;return this._tocOnScroll=this._tocOnScroll||(()=>{if(-1!==n&&n<o.length){o[n].classList.remove("active");let t=o[n].parentElement;for(;t!==e;)t.classList.remove("has-active"),t=t.parentElement.parentElement}const t=a.length;let s=t-1;const l=20+i;for(let e=0;e<t-1;e++){const t=a[e].getBoundingClientRect().top,i=a[e+1].getBoundingClientRect().top;if(0===e&&t>l||t<=l&&i>l){s=e;break}}if(-1!==s&&s<o.length){o[s].classList.add("active");let t=o[s].parentElement;for(;t!==e;)t.classList.add("has-active"),t=t.parentElement.parentElement;n=s}else n=-1}),this._tocOnScroll(),t.addEventListener("scroll",T(()=>{this._tocOnScroll();const t=v.querySelector("a.active");t&&(v.scrollTop=t.offsetTop-50)},100),{passive:!0}),{fixed(t){v.classList.toggle("fixed",t>=s-i)},actived(t){v.classList.remove("post-toc-shrink")}}})(),hideOnMask:[],modal:function(t){if(this.$modal=i(t),!this.$modal)return;this.$off=this.$modal.querySelector(".close");const e=this;this.show=()=>{r.classList.add("in"),e.$modal.classList.add("ready"),requestAnimationFrame(()=>{e.$modal.classList.add("in")})},this.onHide=y,this.hide=()=>{e.onHide(),r.classList.remove("in"),e.$modal.classList.remove("in"),setTimeout(()=>{requestAnimationFrame(()=>{e.$modal.classList.remove("ready")})},300)},this.toggle=()=>e.$modal.classList.contains("in")?e.hide():e.show(),B.hideOnMask.push(this.hide),this.$off&&this.$off.addEventListener(w,this.hide)},share(){const t=new B.modal("#globalShare");$&&$.addEventListener(w,t.toggle),u&&(u.addEventListener(w,()=>{f.classList.toggle("in")},!1),e.addEventListener(w,t=>{!u.contains(t.target)&&f.classList.remove("in")},{passive:!0}));const s=new B.modal("#wxShare");s.onHide=t.hide;for(const t of o(".wxFab"))t.addEventListener(w,s.toggle)},search(){const t=i("#search");t&&t.addEventListener(w,()=>{L.classList.toggle("in")})},waterfall(){if(!(b<760))for(const t of o(".waterfall"))t.classList.add("in")},smoothScroll(){SmoothScroll&&new SmoothScroll('[href^="#"]',{speed:300,speedAsDuration:!0,offset:O+10})},tabBar(t){t.parentNode.parentNode.classList.toggle("expand")},page:(()=>{const t=o(".fade, .fade-scale");let e=!1;return{loaded(){requestAnimationFrame(()=>{for(const e of t)e.classList.add("in");e=!0})},unload(){requestAnimationFrame(()=>{for(const e of t)e.classList.remove("in");e=!1})},visible:e}})(),lightbox:(()=>{const i=[];class a{constructor(t){this.$img=t.querySelector("img"),this.$overlay=t.querySelector("overlay"),this.margin=40,this.title=this.$img.title||this.$img.alt||"",this.isZoom=!1,i.push(this),this.init(t)}init(t){let i,o,a,n,l;const c=this;this.$img.addEventListener("load",()=>{i=this.$img.naturalWidth||this.$img.width,o=this.$img.naturalHeight||this.$img.height}),this.calcRect=()=>{n=s.clientWidth,l=s.clientHeight;const t=l-2*this.margin;let e=i||this.$img.width,c=o||this.$img.height;const r=e>n?n/e:1,d=c>t?t/c:1,h=Math.min(r,d);return e*=h,c*=h,{w:e,h:c,t:(l-c)/2-a.top,l:(n-e)/2-a.left+this.$img.offsetLeft}},this.setImgRect=t=>{this.$img.style.cssText=`width: ${t.w}px; max-width: ${t.w}px; height: ${t.h}px; top: ${t.t}px; left: ${t.l}px`},this.setFrom=()=>{this.setImgRect({w:a.width,h:a.height,t:0,l:(t.offsetWidth-a.width)/2})},this.setTo=()=>{this.setImgRect(this.calcRect())},this.addTitle=()=>{this.title&&(this.$caption=e.createElement("div"),this.$caption.innerHTML=this.title,this.$caption.className="overlay-title",t.appendChild(this.$caption))},this.removeTitle=()=>{this.$caption&&t.removeChild(this.$caption)},this.zoomIn=()=>{i||(i=this.$img.naturalWidth||this.$img.width,o=this.$img.naturalHeight||this.$img.height),a=this.$img.getBoundingClientRect(),t.style.height=`${a.height}px`,t.classList.add("ready"),this.setFrom(),this.addTitle(),this.$img.classList.add("zoom-in"),requestAnimationFrame(()=>{t.classList.add("active"),this.setTo(),this.isZoom=!0})},this.zoomOut=()=>{this.isZoom=!1,t.classList.remove("active"),this.$img.classList.add("zoom-in"),this.setFrom(),setTimeout(()=>{requestAnimationFrame(()=>{this.$img.classList.remove("zoom-in"),this.$img.style.cssText="",this.removeTitle(),t.classList.remove("ready"),t.removeAttribute("style")})},300)},t.addEventListener("click",t=>{c.$img.complete&&(c.isZoom?c.zoomOut():"IMG"===t.target.tagName&&c.zoomIn())})}}if(e.addEventListener("scroll",()=>{i.forEach(t=>{t.isZoom&&t.zoomOut()})},{passive:!0}),t.addEventListener("resize",()=>{i.forEach(t=>{t.isZoom&&t.zoomOut()})},{passive:!0}),t.BLOG.SINGLE)for(const t of o(".img-lightbox"))new a(t)})(),loadScript(t){for(const i of t){const t=e.createElement("script");t.src=i,t.async=!0,s.appendChild(t)}},$:i,$$:o,even:w,noop:y};t.addEventListener("load",()=>{m.classList.remove("active"),B.page.loaded(),t.lazyScripts&&t.lazyScripts.length&&B.loadScript(t.lazyScripts)}),t.addEventListener("DOMContentLoaded",()=>{if(B.waterfall(),t.BLOG.SINGLE){B.initHeaderLink();const t=k();B.toc&&B.toc.fixed(t),B.toc&&B.toc.actived(t)}B.page.loaded(),t.BLOG.even=w});let G=!1;const H=i('a[href^="mailto"]');H&&H.addEventListener(w,()=>{G=!0},{passive:!0}),t.addEventListener("beforeunload",t=>{G?G=!1:B.page.unload()}),t.addEventListener("pageshow",()=>{!B.page.visible&&B.page.loaded()}),t.addEventListener("resize",()=>{w="ontouchstart"in t?"touchstart":"click",t.BLOG.even=w,O=c?.clientHeight||0,b=t.innerWidth,x=p?.clientHeight||0,B.toggleMenu(),B.waterfall()},{passive:!0}),n.addEventListener(w,()=>{E(B.goTop.bind(B,0))},{passive:!0}),d.addEventListener(w,t=>{B.toggleMenu(!0),t.preventDefault()},!1),h.addEventListener(w,()=>{l.classList.add("hide")},{passive:!0}),r.addEventListener(w,t=>{B.toggleMenu(),B.hideOnMask.forEach(t=>t()),t.preventDefault()},!1),e.addEventListener("scroll",T(()=>{const e=k();B.toggleGotop(e),B.fixedHeader(e),t.BLOG.SINGLE&&B.toc&&(B.toc.fixed(e),B.toc.actived(e))},100),{passive:!0}),B.share(),t.BLOG.SINGLE&&B.smoothScroll(),Object.assign(t.BLOG,B),t.Waves?(Waves.init(),Waves.attach(".global-share li",["waves-block"]),Waves.attach(".article-tag-list-link, #page-nav a, #page-nav span",["waves-button"])):console.error("Waves loading failed.")}(window,document);